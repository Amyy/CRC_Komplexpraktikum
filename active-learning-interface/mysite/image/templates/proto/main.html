{%  load static %}

<html>
  <head>
    <meta charset="utf-8">
    <title>Main page</title>
      <!-- meta tag needed for bulma -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link static href="{% static 'css/bulma-0.7.2/css/bulma.css' %}" rel="stylesheet">
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>

  </head>
  <body onload="setLabels()">


    <section class="hero is-info">

      <br/>
      <p>  Logged in as: </p>
      <p> {{user}} </p>
      <button style="height:30px;width:70px"><a href="{% url 'logout'%}">Logout</a></button>
    <div class="hero-body">
        <section class="is-pulled-right">
            <a href="changePassword" class="icon-block">
                <i class="fas fa-cog"></i>
            </a>
        </section>
      <div class="level-item has-text-centered">
        <h1 class="title">
          CRC GUI Prototype
        </h1>
      </div>

    </div>
  </section>

  <section class="section">
    <div class="container">
      <figure class="image is-3by2" >
        <img src="{{ image.data.url }}">
      </figure>
    </div>
  </section>
  <section class="section is-centered">
    <div class="level-item has-text-centered">
      Please select the tool that you can see in the picture and confirm your
      selection by clicking the Submit button
    </div>
  </section>
    <!-- action="getSelectedLabels/{{image}}"  onsubmit="getUserLabels()" method="POST"-->
    <form onsubmit="getUserLabels()"  >
    {% csrf_token %}
      <div class="container">
          {% for label in labels %}
        <div class="level-item has-text-centered">
          <label class="checkbox">
            <input type="checkbox" name="answer" id="{{ label }}">
            {{ label }}
          </label>
        </div>
          {% endfor %}

        <input type="submit" class="button is-link is-centered" value="OK">
      </div>
    </form>

  <p id="demo"></p>
  </body>
    <script type="text/javascript">
        function setLabels() {
            // sets the labels determined by the ML Algorithm
            {% for imageLabel in imageLabels %}
                document.getElementById("{{ imageLabel }}").checked = true
            {% endfor %}

        }

        function sendLabels() {
            var checkboxes = document.getElementsByName("answer")
            var userLabels = []
            for (var i = 0; i < checkboxes.length; i++){
                if (checkboxes[i].checked){
                    userLabels.push(checkboxes[i].id)
                }
            }
            document.getElementById("demo").innerHTML = userLabels
            console.log(userLabels)
            // TODO: hierfür muss sicher noch der entsprechende User übergebn werden
            // wenn es zu dem Aufruf kommt, dann mal in der entsprechenden Pythonfunktion
            // eine Ausgabe so gestalten, dass sie mal den Input angibt
            // danach mal schauen, was das Bild für Labels aufweist
            //{ Userlabels.objects.set_userlabels(image, user, userLabels) }

        }



    </script>
</html>
